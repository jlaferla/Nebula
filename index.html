<script>
    // Function to send data and display response
    async function sendData() {
        var acquirerId = document.getElementById("acquirerId").value;
        var merchantId = document.getElementById("merchantId").value;
        var baseAmount = document.getElementById("baseAmount").value;
        var currency = document.getElementById("currency").value;

        // Store the generated URL in the variable
        var generatedURL = `https://dhsrest.fmsapps.com/dhsv2/acquirers/${acquirerId}/merchants/${merchantId}/dccoffers?currency=${currency}&baseamount=${baseAmount}`;

        try {
            // Fetch JSON response from the generated URL
            var response = await fetch(generatedURL);
            var responseData = await response.json();

            // Check if the word "No such Merchant" is mentioned in the response
            if (JSON.stringify(responseData).toLowerCase().includes("no such merchant")) {
                // Display the not setup banner
                document.getElementById("notSetupBanner").style.display = "block";
                document.getElementById("notAvailableBanner").style.display = "none";
                // Hide the response content
                document.getElementById("responseData").innerHTML = "";
                // Hide the statement about the margin
                document.getElementById("marginStatement").style.display = "none";
            } else if (JSON.stringify(responseData).includes("{}")) {
                // Display the not available banner
                document.getElementById("notAvailableBanner").style.display = "block";
                document.getElementById("notSetupBanner").style.display = "none";
                // Hide the response content
                document.getElementById("responseData").innerHTML = "";
                // Hide the statement about the margin
                document.getElementById("marginStatement").style.display = "none";
            } else if (JSON.stringify(responseData).toLowerCase().includes("rate")) {
                // Display the table with rate and foreignAmount
                document.getElementById("notSetupBanner").style.display = "none";
                document.getElementById("notAvailableBanner").style.display = "none";

                var exchangeRate = responseData.exchangeRate;
                var foreignAmount = responseData.foreignAmount;

                var tableContent = `<table>
                                        <tr>
                                            <th>Field</th>
                                            <th>Value</th>
                                        </tr>
                                        <tr>
                                            <td>Exchange Rate</td>
                                            <td>${exchangeRate.rate}</td>
                                        </tr>
                                        <tr>
                                            <td>Foreign Amount</td>
                                            <td>${foreignAmount}</td>
                                        </tr>
                                    </table>`;

                // Display the table content
                document.getElementById("responseData").innerHTML = tableContent;

                // Display the statement about the margin
                document.getElementById("marginStatement").style.display = "block";
            } else {
                // Hide the banners if none of the conditions are met
                document.getElementById("notSetupBanner").style.display = "none";
                document.getElementById("notAvailableBanner").style.display = "none";

                // Log the generated URL to the console (you can modify this to perform other actions)
                console.log("Generated URL:", generatedURL);

                // Format and display the JSON data on the page
                var responseContent = JSON.stringify(responseData, null, 2);
                document.getElementById("responseData").innerHTML = "<p style='color: #8013d3;'><strong>Response:</strong></p><pre class='response-text'>" + responseContent + "</pre>";

                // Hide the statement about the margin
                document.getElementById("marginStatement").style.display = "none";
            }

        } catch (error) {
            console.error("Error fetching data:", error);
        }
    }
</script>
